<!DOCTYPE html>
<html lang="en">

<head>
    <title>The Lunchbox - Menu Upload</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/x-icon" href="content/favicon.png">

    <script type="module">
        // Include the main Firebase App script
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-app.js";
        // Include the script for the specific Firebase module you need (Firestore in this case)
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-analytics.js";
        import { getFirestore, doc, setDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-firestore.js";
        // Import Authentication module
        import { getAuth } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-auth.js";
      
        const firebaseConfig = {
          apiKey: "AIzaSyCH0Zyzj5tukPUZacOM_xJZk3wFLQIvgNw",
          authDomain: "lunchbox-60fb5.firebaseapp.com",
          databaseURL: "https://lunchbox-60fb5-default-rtdb.firebaseio.com",
          projectId: "lunchbox-60fb5",
          storageBucket: "lunchbox-60fb5.appspot.com",
          messagingSenderId: "534903316915",
          appId: "1:534903316915:web:e7b8e503540d234632ebc6",
          measurementId: "G-TD5GSSYSSY"
        };
      
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
      
        // Reference to the realtime database
        const db = getFirestore(app);
        const auth = getAuth(app);
      
        // Function to handle form submission
        function submitForm(event) {
          event.preventDefault();
          const email = document.getElementById('emailINPUT').value;
          const password = document.getElementById('passwordINPUT').value;
      
          auth.signInWithEmailAndPassword(email, password)
            .then((userCredential) => {
              console.log("Authentication successful!");
      
              // Get values from input fields
              const dateINPUT1 = document.getElementById('dateINPUT1').value;
              const entreeINPUT1 = document.getElementById('entreeINPUT1').value;
              const soupINPUT1 = document.getElementById('soupINPUT1').value;
              const saladINPUT1 = document.getElementById('saladINPUT1').value;
              const sideINPUT1 = document.getElementById('sideINPUT1').value;
              const dessertINPUT1 = document.getElementById('dessertINPUT1').value;
              const exceptionINPUT1 = document.getElementById('explanationINPUT1').value;
      
              const dateINPUT2 = document.getElementById('dateINPUT2').value;
              const entreeINPUT2 = document.getElementById('entreeINPUT2').value;
              const soupINPUT2 = document.getElementById('soupINPUT2').value;
              const saladINPUT2 = document.getElementById('saladINPUT2').value;
              const sideINPUT2 = document.getElementById('sideINPUT2').value;
              const dessertINPUT2 = document.getElementById('dessertINPUT2').value;
              const exceptionINPUT2 = document.getElementById('explanationINPUT2').value;
      
              const dateINPUT3 = document.getElementById('dateINPUT3').value;
              const entreeINPUT3 = document.getElementById('entreeINPUT3').value;
              const soupINPUT3 = document.getElementById('soupINPUT3').value;
              const saladINPUT3 = document.getElementById('saladINPUT3').value;
              const sideINPUT3 = document.getElementById('sideINPUT3').value;
              const dessertINPUT3 = document.getElementById('dessertINPUT3').value;
              const exceptionINPUT3 = document.getElementById('explanationINPUT3').value;
      
              // Construct menu data object
              const menuData = {
                tuesday: {
                  date: dateINPUT1,
                  entree: entreeINPUT1,
                  soup: soupINPUT1,
                  salad: saladINPUT1,
                  side: sideINPUT1,
                  dessert: dessertINPUT1,
                  explanation: explanationINPUT1
                },
                wednesday: {
                  date: dateINPUT2,
                  entree: entreeINPUT2,
                  soup: soupINPUT2,
                  salad: saladINPUT2,
                  side: sideINPUT2,
                  dessert: dessertINPUT2,
                  explanation: explanationINPUT2
                },
                thursday: {
                  date: dateINPUT3,
                  entree: entreeINPUT3,
                  soup: soupINPUT3,
                  salad: saladINPUT3,
                  side: sideINPUT3,
                  dessert: dessertINPUT3,
                  explanation: explanationINPUT3
                }
              };
      
              console.log("Menu data:", menuData);
      
              // Update the realtime database
              setDoc(doc(db, "menu", "menuDocument"), menuData)
                .then(() => {
                  console.log("Menu published successfully!");
                  alert("Menu published successfully!");
                })
                .catch((error) => {
                  console.error("Error publishing menu: ", error);
                  alert("Error publishing menu. Check the console for details.");
                });
            })
            .catch((error) => {
              console.error("Authentication failed: ", error);
              alert("Authentication failed. Check the console for details.");
            });
        }
      </script>
    </head>
    <nav>
        <div class="nav-upload-middle">
            <img id="logo-upload-middle" src="content/lunchboxWithText.png" alt="lunchboxLogoWithText">
        </div>
    </nav>
      <main>
        <div class="upload-container">
            <div class="upload-card">
                <form class="upload-form">
                    <input id="dateINPUT1" type="text" placeholder="Tuesday - Date (num)" style="background-color:silver">
                    <input id="entreeINPUT1" type="text" placeholder="Tuesday - Entree" style="background-color:silver">
                    <input id="soupINPUT1" type="text" placeholder="Tuesday - Soups" style="background-color:silver">
                    <input id="saladINPUT1" type="text" placeholder="Tuesday - Salads" style="background-color:silver">
                    <input id="sideINPUT1" type="text" placeholder="Tuesday - Sides" style="background-color:silver">
                    <input id="dessertINPUT1" type="text" placeholder="Tuesday - Desserts" style="background-color:silver">
                    <label class="checkbox-label">
                        <input id="closedCHECKBOX1" type="checkbox" class="custom-checkbox">
                        <span class="checkbox-text">closed</span>
                    </label>
                    <input id="explanationINPUT1" type="text" placeholder="explanation - why closed?" style="background-color:silver">
                </form>
            </div>
            <div class="upload-card">
                <form class="upload-form">
                    <input id="dateINPUT2" type="text" placeholder="Wednesday - Date (num)" style="background-color:silver">
                    <input id="entreeINPUT2" type="text" placeholder="Wednesday - Entree" style="background-color:silver">
                    <input id="soupINPUT2" type="text" placeholder="Wednesday - Soups" style="background-color:silver">
                    <input id="saladINPUT2" type="text" placeholder="Wednesday - Salads" style="background-color:silver">
                    <input id="sideINPUT2" type="text" placeholder="Wednesday - Sides" style="background-color:silver">
                    <input id="dessertINPUT2" type="text" placeholder="Wednesday - Desserts" style="background-color:silver">
                    <label class="checkbox-label">
                        <input id="closedCHECKBOX2" type="checkbox" class="custom-checkbox">
                        <span class="checkbox-text">closed</span>
                    </label>
                    <input id="explanationINPUT2" type="text" placeholder="explanation - why closed?" style="background-color:silver">
                </form>
            </div>
            <div class="upload-card">
                <form class="upload-form">
                    <input id="dateINPUT3" type="text" placeholder="Thursday - Date (num)" style="background-color:silver">
                    <input id="entreeINPUT3" type="text" placeholder="Thursday - Entree" style="background-color:silver">
                    <input id="soupINPUT3" type="text" placeholder="Thursday - Soups" style="background-color:silver">
                    <input id="saladINPUT3" type="text" placeholder="Thursday - Salads" style="background-color:silver">
                    <input id="sideINPUT3" type="text" placeholder="Thursday - Sides" style="background-color:silver">
                    <input id="dessertINPUT3" type="text" placeholder="Thursday - Desserts" style="background-color:silver">
                    <label class="checkbox-label">
                        <input id="closedCHECKBOX3" type="checkbox" class="custom-checkbox">
                        <span class="checkbox-text">closed</span>
                    </label>
                    <input id="explanationINPUT3" type="text" placeholder="explanation - why closed?" style="background-color:silver">
                </form>
            </div>   
            <div class="upload-card">
                <form class="upload-form">
                  <input id="emailINPUT" class="email-textbox" type="text" placeholder="email" style="background-color:#e56b6f">
                  <input id="passwordINPUT" type="text" placeholder="password" style="background-color:#e56b6f">
                    <button type="submit">publish</button>
                    * publishing replaces all current menu details
                </form>
            </div>   
        </div>
    </main>
    <footer>
        &copy; Maekyn Grigsby & Ty Tichenor<br>
        The Lunchbox <br>
        1901 Lynch Rd, Evansville, IN 47711 <br>
        <a href="https://sictc.evscschools.com/"><img src="content/footerSICTC.png" style="width:150px;height:75px;" alt="footerSICTC"></a>
    </footer>
</body>
</html>
