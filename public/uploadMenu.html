<!DOCTYPE html>
<html lang="en">

<head>
    <title>The Lunchbox - Menu Upload</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/x-icon" href="content/favicon.png">

    <script type="module">
        // Include the main Firebase App script
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-app.js";
        // Include the script for the specific Firebase module you need (Firestore in this case)
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-analytics.js";
        import { getAuth, getFirestore, doc, setDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-firestore.js";
      
        const firebaseConfig = {
          apiKey: "AIzaSyCH0Zyzj5tukPUZacOM_xJZk3wFLQIvgNw",
          authDomain: "lunchbox-60fb5.firebaseapp.com",
          databaseURL: "https://lunchbox-60fb5-default-rtdb.firebaseio.com",
          projectId: "lunchbox-60fb5",
          storageBucket: "lunchbox-60fb5.appspot.com",
          messagingSenderId: "534903316915",
          appId: "1:534903316915:web:e7b8e503540d234632ebc6",
          measurementId: "G-TD5GSSYSSY"
        };
      
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
      
        // Reference to the realtime database
        const db = getFirestore(app);
        const auth = getAuth(app);
      
        // Function to handle form submission
        function submitForm(event) {
          event.preventDefault();
          const email = document.getElementById('email').value;
          const password = document.getElementById('password').value;
      
          auth.signInWithEmailAndPassword(email, password)
            .then((userCredential) => {
              console.log("Authentication successful!");
      
              // Get values from input fields
              const dateInput1 = document.getElementById('dateINPUT1').value;
              const entreeInput1 = document.getElementById('entreeINPUT1').value;
              const soupInput1 = document.getElementById('soupINPUT1').value;
              const saladInput1 = document.getElementById('saladINPUT1').value;
              const sideInput1 = document.getElementById('sideINPUT1').value;
              const dessertInput1 = document.getElementById('dessertINPUT1').value;
              const exceptionInput1 = document.getElementById('excINPUT1').value;
      
              const dateInput2 = document.getElementById('dateINPUT2').value;
              const entreeInput2 = document.getElementById('entreeINPUT2').value;
              const soupInput2 = document.getElementById('soupINPUT2').value;
              const saladInput2 = document.getElementById('saladINPUT2').value;
              const sideInput2 = document.getElementById('sideINPUT2').value;
              const dessertInput2 = document.getElementById('dessertINPUT2').value;
              const exceptionInput2 = document.getElementById('excINPUT2').value;
      
              const dateInput3 = document.getElementById('dateINPUT3').value;
              const entreeInput3 = document.getElementById('entreeINPUT3').value;
              const soupInput3 = document.getElementById('soupINPUT3').value;
              const saladInput3 = document.getElementById('saladINPUT3').value;
              const sideInput3 = document.getElementById('sideINPUT3').value;
              const dessertInput3 = document.getElementById('dessertINPUT3').value;
              const exceptionInput3 = document.getElementById('excINPUT3').value;
      
              // Construct menu data object
              const menuData = {
                tuesday: {
                  date: dateInput1,
                  entree: entreeInput1,
                  soup: soupInput1,
                  salad: saladInput1,
                  side: sideInput1,
                  dessert: dessertInput1,
                  exception: exceptionInput1
                },
                wednesday: {
                  date: dateInput2,
                  entree: entreeInput2,
                  soup: soupInput2,
                  salad: saladInput2,
                  side: sideInput2,
                  dessert: dessertInput2,
                  exception: exceptionInput2
                },
                thursday: {
                  date: dateInput3,
                  entree: entreeInput3,
                  soup: soupInput3,
                  salad: saladInput3,
                  side: sideInput3,
                  dessert: dessertInput3,
                  exception: exceptionInput3
                }
              };
      
              console.log("Menu data:", menuData);
      
              // Update the realtime database
              setDoc(doc(db, "menu"), menuData)
                .then(() => {
                  console.log("Menu published successfully!");
                  alert("Menu published successfully!");
                })
                .catch((error) => {
                  console.error("Error publishing menu: ", error);
                  alert("Error publishing menu. Check the console for details.");
                });
            })
            .catch((error) => {
              console.error("Authentication failed: ", error);
              alert("Authentication failed. Check the console for details.");
            });
        }
      </script>
      
    </head>





    <nav>
        <div class="nav-upload-middle">
            <img id="logo-upload-middle" src="content/lunchboxWithText.png" alt="lunchboxLogoWithText">
        </div>
    </nav>
    <main>
        <div class="upload-card">
            <h2>UPLOAD MENU</h2><br>
            <h3>Separate items with commas</h3>
            <form id="menuUploadForm" class="upload-form" onSubmit="submitForm(event)">
                <input id="email" type="email" placeholder="Email" required style="background-color:#e56b6f">
                            <input id="password" type="password" placeholder="Password" required style="background-color:#e56b6f">
                            <input id="dateINPUT1" type="text" placeholder="Date (number)" style="background-color:silver">
                            <input id="entreeINPUT1" type="text" placeholder="Tuesday - Entree" style="background-color:silver">
                            <input id="soupINPUT1" type="text" placeholder="Tuesday - Soups" style="background-color:silver">
                            <input id="saladINPUT1" type="text" placeholder="Tuesday - Salads" style="background-color:silver">
                            <input id="sideINPUT1" type="text" placeholder="Tuesday - Sides" style="background-color:silver">
                            <input id="dessertINPUT1" type="text" placeholder="Tuesday - Desserts" style="background-color:silver">
                            <input id="excINPUT1" type="text" placeholder="Exceptions ex: reason why closed" style="background-color:silver">
                            <input id="dateINPUT2" type="text" placeholder="Date (number)" style="background-color:silver">
                            <input id="entreeINPUT2" type="text" placeholder="Wednesday - Entree" style="background-color: white">
                            <input id="soupINPUT2" type="text" placeholder="Wednesday - Soups" style="background-color: white">
                            <input id="saladINPUT2" type="text" placeholder="Wednesday - Salads" style="background-color: white">
                            <input id="sideINPUT2" type="text" placeholder="Wednesday - Sides" style="background-color: white">
                            <input id="dessertINPUT2" type="text" placeholder="Wednesday - Desserts" style="background-color: white">
                            <input id="excINPUT2" type="text" placeholder="Exceptions ex: reason why closed" style="background-color: white">
                            <input id="dateINPUT3" type="text" placeholder="Date (number)" style="background-color:silver">
                            <input id="entreeINPUT3" type="text" placeholder="Thursday - Entree" style="background-color: silver">
                            <input id="soupINPUT3" type="text" placeholder="Thursday - Soups" style="background-color: silver">
                            <input id="saladINPUT3" type="text" placeholder="Thursday - Salads" style="background-color: silver">
                            <input id="sideINPUT3" type="text" placeholder="Thursday - Sides" style="background-color: silver">
                            <input id="dessertINPUT3" type="text" placeholder="Thursday - Desserts" style="background-color: silver">
                            <input id="excINPUT3" type="text" placeholder="Exceptions ex: reason why closed" style="background-color:silver">
                <button type="submit">Publish</button>
                * publishing replaces all current menu details
            </form>
        </div>
    </main>
    <footer>
        &copy; Maekyn Grigsby & Ty Tichenor<br>
        The Lunchbox <br>
        1901 Lynch Rd, Evansville, IN 47711 <br>
        <a href="https://sictc.evscschools.com/"><img src="content/footerSICTC.png" style="width:150px;height:75px;" alt="footerSICTC"></a>
    </footer>
</body>

</html>
