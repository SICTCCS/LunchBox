this is from the firebase branch